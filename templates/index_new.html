<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samsung Notes to iOS Converter</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <style>
        :root {
            --primary-color: #FFD180;
            --secondary-color: #FFE0B2;
            --sidebar-logo-color: #FFD180;
            --accent-color: #FFAB40;
            --text-color: #5D4037;
            --bg-color: #FFF8E1;
        }
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        .alert-banner {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40%;
            z-index: 1000;
        }
        .wrapper {
            display: flex;
            width: 100%;
            align-items: stretch;
        }
        #sidebar {
            min-width: 80px;
            max-width: 80px;
            min-height: 100vh;
            transition: all 0.3s;
            background-color: var(--primary-color);
            color: var(--text-color);
        }
        #sidebar.expanded {
            min-width: 250px;
            max-width: 250px;
        }
        #content {
            width: 100%;
            padding: 20px;
            min-height: 100vh;
            transition: all 0.3s;
        }
        .sidebar-logo {
            max-width: 100%;
        }
        #sidebar .nav-link {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            color: var(--text-color);
            transition: all 0.3s;
            width: 100%;
            border-left: 4px solid transparent;
        }
        #sidebar .nav-link:hover, #sidebar .nav-link.active {
            background-color: var(--secondary-color);
            border-left-color: var(--accent-color);
        }
        #sidebar .nav-link span {
            display: none;
            margin-left: 15px;
        }
        #sidebar.expanded .nav-link {
            justify-content: flex-start;
        }
        #sidebar.expanded .nav-link span {
            display: inline;
        }
        .header-logo{
            max-width: 500px;
        }
        .images {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        .images img {
            margin: 0 10px;
            max-width: 100px;
        }
        .images .img2 {
            margin: 0 20px;
            max-width: 50px;
        }
        .sidebar-header {
            padding: 20px;
            background-color: var(--sidebar-logo-color);
            width: 100%;
            display: flex;
            justify-content: center;
        }
        .logo-placeholder {
            width: 40px;
            height: 40px;
            background-color: var(--secondary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--text-color);
        }
        #upload-area {
            border: 2px dashed var(--accent-color);
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            background-color: var(--secondary-color);
            width: 80%;
            margin: 0 auto;
            transition: all 0.3s;
        }
        #upload-area.dragover {
            background-color: var(--primary-color);
            border-color: var(--accent-color);
        }
        #upload-area h3 {
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--text-color);
        }
        h1, h2, h3 {
            color: var(--text-color);
        }
        #sidebar .nav {
            width: 100%;
        }
        .icon-circle {
            width: 120px;
            height: 120px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            transition: all 0.3s;
        }
        .icon-circle:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .icon-circle i {
            font-size: 50px;
            color: var(--text-color);
        }
        .icon-text {
            text-align: center;
            color: var(--text-color);
            font-weight: 500;
            font-size: 1.1rem;
        }
        .icon-subtext {
            text-align: center;
            color: var(--text-color);
            font-size: 1.1rem;
            text-align: center;
            padding-left: 50px;
            padding-right: 50px;
        }
        .instruction-step {
            margin-bottom: 40px;
            background-color: var(--secondary-color);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .instruction-step h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .step-number {
            width: 50px;
            height: 50px;
            background-color: var(--accent-color);
            color: var(--bg-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 20px;
            flex-shrink: 0;
            font-size: 1.2rem;
        }
        .instruction-step .col-md-6 {
            padding-left: 30px;
            padding-right: 30px;
        }
        #fileInput {
            display: none;
        }
        #fileList {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 30px;
        }
        .file-item {
            text-align: center;
            margin: 15px;
            background-color: var(--secondary-color);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: all 0.3s;
            position: relative;
        }
        .file-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        .file-icon {
            font-size: 3.5rem;
            color: var(--accent-color);
            margin-bottom: 10px;
        }
        .file-name {
            font-size: 0.9rem;
            color: var(--text-color);
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .remove-file {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background-color: var(--accent-color);
            color: var(--bg-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        .remove-file:hover {
            background-color: #FF6E40;
        }
        .progress {
            display: none;
            margin-top: 20px;
        }
        .progress-bar {
            width: 0%;
            height: 20px;
            background-color: var(--primary-color);
            transition: width 0.3s;
        }
        #conversion-summary, #download-section {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        .btn-success, .btn-reset {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        .btn-success:hover, .btn-reset:hover {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
        }
        #upload-button {
            display: block;
            margin: 20px auto 0;
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        #upload-button:hover {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <!-- Sidebar -->
        <nav id="sidebar">
            <div class="sidebar-header">
                <div class="logo-placeholder">
                    <img class="sidebar-logo" src="{{ url_for('static', filename='logo.png') }}" alt="NoteSwitch">
                </div>
            </div>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active" href="#" data-page="home">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-page="convert">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Convert</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-page="history">
                        <i class="fas fa-history"></i>
                        <span>History</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-page="instructions">
                        <i class="fas fa-book"></i>
                        <span>Instructions</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-page="settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-page="help">
                        <i class="fas fa-question-circle"></i>
                        <span>Help</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main content -->
        <main id="content">
            <div id="home-page">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12 text-center mb-5">
                            <img class="header-logo" src="{{  url_for('static', filename='logo2.png')  }}" alt="NoteSwitch">
                            <div class="images">
                                <!-- <img src="https://upload.wikimedia.org/wikipedia/commons/a/a3/Samsung_Notes_icon.png" alt="Stock Image 1">
                                <i class="fas fa-download"></i>
                                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Apple_Notes_icon.svg/800px-Apple_Notes_icon.svg.png" alt="Stock Image 3"> -->
                            </div>
                            <!-- <h1 class="fw-bold">Convert Samsung Notes <img src="https://upload.wikimedia.org/wikipedia/commons/a/a3/Samsung_Notes_icon.png" alt="Stock Image 1" style="max-width: 4%;"> to <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Apple_Notes_icon.svg/800px-Apple_Notes_icon.svg.png" style="max-width: 4%;" alt="Stock Image 3"> Apple Notes </h1> -->
                            <!-- <p class="lead text-muted">Seamlessly transfer your <b class="fw-bold">Samsung Notes</b> <img src="https://upload.wikimedia.org/wikipedia/commons/a/a3/Samsung_Notes_icon.png" alt="Stock Image 1" style="max-width: 3%; padding-left: 2px;"> to your <b class="fw-bold">Apple</b> devices. <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Apple_Notes_icon.svg/800px-Apple_Notes_icon.svg.png" style="max-width: 3%; padding-left: 2px;" alt="Stock Image 3"></h1> -->
                            <h2 class="text-muted" style="font-weight: 100;">Seamlessly transfer your <b class="fw-bold">Samsung Notes</b> to your <b class="fw-bold">Apple</b> devices.</h2>
                            <h4 class="text-muted" style="font-weight: 100;"><i class="fas fa-square-check" style="margin-right:10px;"></i><b class="fw-bold">Samsung Notes</b> to your <b class="fw-bold">Apple</b> devices.</h4>

                            </div>
                    </div>

                    <div class="row mb-5">
                        <div class="col-md-4 justify-content-center align-items-center">
                            <div class="icon-circle" style="background-color: #ee9c92;">
                                <!-- <i class="fas fa-file-upload"></i> -->
                                <img src="https://upload.wikimedia.org/wikipedia/commons/a/a3/Samsung_Notes_icon.png" style="max-width: 60%;" alt="Stock Image 1">
                            </div>
                            <p class="icon-text">Prepare Notes</p>
                            <p class="icon-subtext">Follow <a href="#" data-page="instructions">these instructions</a> to export your notes from your Samsung device.</p>
                        </div>
                        <div class="col-md-4">
                            <div class="icon-circle">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <p class="icon-text">Convert</p>
                            <p class="icon-subtext">Drag, drop or select the exported zip files into the field below and click "Convert".</p>
                        </div>
                        <div class="col-md-4">
                            <div class="icon-circle" style="background-color: #f0e2b6;">
                                <!-- <i class="fas fa-download"></i> -->
                                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Apple_Notes_icon.svg/800px-Apple_Notes_icon.svg.png" style="max-width: 50%;" alt="Stock Image 1">
                            </div>
                            <p class="icon-text">Download</p>
                            <p class="icon-subtext">Download the converted files to your Apple device and extract them from the zip file. Select all files and open in the Notes app.</p>

                        </div>
                    </div>

                    <div id="upload-area" class="mt-4">
                        <h3>Drag & Drop Samsung Notes Files Here or Click to Upload</h3>
                        <p class="text-muted mt-2">Supported file types: .zip</p>
                        <input type="file" id="fileInput" class="form-control" multiple>
                    </div>
                    <div id="fileList" class="mt-4"></div>
                    <button id="upload-button" class="btn btn-primary mt-3" style="display: none;">Upload</button>

                    <div class="progress mt-3">
                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                    </div>
                    <div id="conversion-summary" class="mt-3">
                        <p id="success-count"></p>
                        <p id="error-list"></p>
                    </div>
                    <div id="download-section" class="mt-3">
                        <a id="download-link" href="/download" class="btn btn-success">Download Export.zip</a>
                        <button id="reset-button" class="btn btn-reset">Reset</button>
                    </div>
                </div>
            </div>
            
            <div id="instructions-page" style="display: none;">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12">
                            <h1 class="mb-4">Instructions</h1>
                            <div class="instruction-step">
                                <h3>
                                    <div class="step-number">1</div>
                                    Prepare Your Samsung Notes
                                </h3>
                                <div class="row align-items-center">
                                    <div class="col-md-6">
                                        <p>Export your Samsung Notes to a supported file format (.snb or .txt). Open the Samsung Notes app, select the notes you want to convert, tap the share button, and choose the export option.</p>
                                    </div>
                                    <div class="col-md-6">
                                        <img src="/api/placeholder/400/300" alt="Prepare Samsung Notes" class="img-fluid rounded">
                                    </div>
                                </div>
                            </div>
                            <div class="instruction-step">
                                <h3>
                                    <div class="step-number">2</div>
                                    Upload Your Files
                                </h3>
                                <div class="row align-items-center">
                                    <div class="col-md-6">
                                        <img src="/api/placeholder/400/300" alt="Upload Files" class="img-fluid rounded">
                                    </div>
                                    <div class="col-md-6">
                                        <p>Drag and drop your exported Samsung Notes files into the upload area on the home page, or click to select files from your device. You can upload multiple files at once.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="instruction-step">
                                <h3>
                                    <div class="step-number">3</div>
                                    Convert Your Notes
                                </h3>
                                <div class="row align-items-center">
                                    <div class="col-md-6">
                                        <p>Once your files are uploaded, click the "Convert" button. Our system will process your Samsung Notes and convert them into a format compatible with iOS devices. The conversion process is quick and secure.</p>
                                    </div>
                                    <div class="col-md-6">
                                        <img src="/api/placeholder/400/300" alt="Convert Notes" class="img-fluid rounded">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const sidebar = document.getElementById('sidebar');
        const navLinks = document.querySelectorAll('#sidebar .nav-link');
        const pages = document.querySelectorAll('#content > div');

        let sidebarExpanded = false;

        sidebar.addEventListener('mouseenter', () => {
            sidebar.classList.add('expanded');
        });

        sidebar.addEventListener('mouseleave', () => {
            if (!sidebarExpanded) {
                sidebar.classList.remove('expanded');
            }
        });

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                sidebarExpanded = !sidebarExpanded;
                if (!sidebarExpanded) {
                    sidebar.classList.remove('expanded');
                }

                navLinks.forEach(navLink => navLink.classList.remove('active'));
                link.classList.add('active');

                const pageId = link.getAttribute('data-page');
                pages.forEach(page => {
                    page.style.display = page.id === `${pageId}-page` ? 'block' : 'none';
                });
            });
        });

        // Drag and drop functionality
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('fileInput');
        const fileList = document.getElementById('fileList');
        const uploadButton = document.getElementById('upload-button');
        const progressBar = document.querySelector('.progress-bar');
        const conversionSummary = document.getElementById('conversion-summary');
        const successCount = document.getElementById('success-count');
        const errorList = document.getElementById('error-list');
        const downloadSection = document.getElementById('download-section');
        const downloadLink = document.getElementById('download-link');
        const resetButton = document.getElementById('reset-button');

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            uploadArea.classList.add('dragover');
        }

        function unhighlight() {
            uploadArea.classList.remove('dragover');
        }

        uploadArea.addEventListener('drop', handleDrop, false);
        uploadArea.addEventListener('click', () => fileInput.click());

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        fileInput.addEventListener('change', function() {
            handleFiles(this.files);
        });

        function handleFiles(files) {
            fileList.innerHTML = '';
            [...files].forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.dataset.index = index;
                
                const icon = document.createElement('i');
                icon.className = 'fas fa-file file-icon';
                
                const fileName = document.createElement('div');
                fileName.className = 'file-name';
                fileName.textContent = file.name;
                
                const removeButton = document.createElement('div');
                removeButton.className = 'remove-file';
                removeButton.innerHTML = '&times;';
                removeButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    removeFile(index);
                });
                
                fileItem.appendChild(icon);
                fileItem.appendChild(fileName);
                fileItem.appendChild(removeButton);
                fileList.appendChild(fileItem);
            });

            // Show a success message
            showMessage('Files uploaded successfully!', 'success');
            uploadButton.style.display = 'block';
        }

        function removeFile(index) {
            const fileItems = document.querySelectorAll('.file-item');
            fileItems[index].remove();
            
            // Update file input
            const dt = new DataTransfer();
            const input = document.getElementById('fileInput');
            const { files } = input;
            
            for (let i = 0; i < files.length; i++) {
                if (i !== index) dt.items.add(files[i]);
            }
            
            input.files = dt.files;

            showMessage('File removed successfully!', 'warning');
        }

        function showMessage(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-banner alert-${type} mt-3`;
            alertDiv.textContent = message;
            document.querySelector('.container-fluid').insertBefore(alertDiv, fileList);

            // Remove the alert after 3 seconds
            setTimeout(() => {
                alertDiv.remove();
            }, 3000);
        }

        uploadButton.addEventListener('click', function() {
            handleFileUpload(fileInput.files[0]);
            uploadArea.style.display = 'none';
            uploadButton.style.display = 'none';
        });

        resetButton.addEventListener('click', function() {
            location.reload();
        });

        function handleFileUpload(file) {
            const formData = new FormData();
            formData.append('file', file);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === "Processing started") {
                    const totalFiles = data.total_files;
                    document.querySelector('.progress').style.display = 'block';
                    const interval = setInterval(function() {
                        fetch('/progress')
                        .then(response => response.json())
                        .then(progressData => {
                            const processedFiles = progressData.processed;
                            const percentage = Math.round((processedFiles / totalFiles) * 100);
                            progressBar.style.width = `${percentage}%`;
                            progressBar.setAttribute('aria-valuenow', percentage);
                            progressBar.textContent = `${percentage}%`;

                            successCount.textContent = `${progressData.successful}/${totalFiles} files successfully converted!`;

                            if (progressData.unsuccessful.length > 0) {
                                errorList.innerHTML = 'Failed to convert the following files:<br>' + progressData.unsuccessful.join('<br>');
                            } else {
                                errorList.innerHTML = '';
                            }

                            if (progressData.done) {
                                clearInterval(interval);
                                downloadSection.style.display = 'block';
                                conversionSummary.style.display = 'block';
                            }
                        });
                    }, 1000);
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html>
